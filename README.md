# LOVE20 行动扩展协议之 LP 扩展协议

## 0. 关于协议

此扩展协议，基于 LOVE20 扩展协议标准，扩展行动参与机制，允许以 LP 参与行动，获得铸币激励。

## 1. 核心优势

### 1.1 自动化公平验证

在关键交互点自动触发验证结果生成，无需治理者人工验证

### 1.2 防止闪电贷攻击

无法在一个区块内完成质押、获取激励、并取回质押资产，可从根本上杜绝闪电贷攻击

### 1.3 长期主义激励机制

与治理票绑定，将参与资格与激励大小，与治理票占比绑定，只有长期主义者才能获得更多激励

## 2. 初始参数

### 2.1 最小治理票数 (minGovVotes)

首次质押代币时，行动者必须持有大于等于 `minGovVotes` 的治理票数，以确保行动者参与治理。

### 2.2 等待区块数 (waitingBlocks)

距离最后一次参与超过等待区块数后，随时可取回参与代币

### 2.3 参与代币地址(joinTokenAddress)

用来参与行动的代币合约地址

### 2.4 治理票占比倍数 (govRatioMultiplier)

在计算分数时，治理票占比会乘以 `govRatioMultiplier`，用于调整治理票在分数计算中的权重。

### 2.5 LP 占比精度 (lpRatioPrecision)

参与的 LP 代币数量占比需高于： 1 / LP 占比精度

## 3. 行动者

### 3.1 代币参与

行动者参与代币，被验证后，获得铸币激励

参与条件：

- 首次参与：必须持有至少 `minGovVotes` 的治理票数
- 参与数量必须大于 0

### 3.2 代币取回

距离最后一次参与超过等待区块数后，随时可取回参与代币

### 3.4 铸造激励

行动者可以在验证阶段完成后，铸造行动激励，溢出激励讲同步销毁。

激励根据以下公式分配：

```
理论激励 = 行动总激励 x 代币占比
溢出激励 = 行动总激励 x (1 - MIN(代币占比, 治理票占比 * govRatioMultiplier) / 代币占比)
实际激励 = 理论激励 - 溢出激励
```

其中：

- 代币占比 = 参与代币数量 / 总参与代币数量
- 治理票占比 = 有效治理票数 / 总治理票数
